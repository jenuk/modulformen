\section{Die Heckeoperatoren $T(n)$}

\begin{defi}\label{defiM(n)}
Sei $n \in \NN$. Setze 
\[
\mathcal M(n) := \Set{ \abcd \in M_2(\ZZ) \Bigm| ad - bc = n }
\,.
\]
\end{defi}

\emph{Beobachtung:} $\mathcal M(n)$ ist invariant unter Links- und Rechtsmultiplikation von $\Gamma (1)$. 

\begin{lemm}\label{lemma:Mn_schoen}
\[
\mathcal M (n) = \smashoperator{\bigcup_{\substack{ad = n\\ d > 0\\b (\operatorname{mod} d)}}^{\boldsymbol{\cdot}}} \, \Gamma(1) \cdot 
\begin{pmatrix}
a & b\\
0 & d
\end{pmatrix}
\,,
\]
wobei die Vereinigung über alle Matrizen $\mymat ab0d$ geht, derart dass $a,b,d \in \ZZ$, $ad = n$, $d > 0$, und $b$ ein volles Restsystem modulo $d$ durchläuft (also z.B. $b \in \Set{1, 2, \ldots, d}$).
\end{lemm}

\begin{bewe}
Die Inklusion $\supseteq$ ist klar, zeige also noch $\subset$. Sei dazu $M = \abcd \in \mathcal M (n)$. Da $ad-bc = n > 0$, können $a$ und $c$ nicht gleichzeitig Null sein. Deswegen existiert $t := \ggt (a,c) \in \NN$. Also sind $-\frac ct$ und $\frac at$ teilerfremd und es existieren $\alpha, \beta \in \ZZ$ mit
\[
\begin{pmatrix}
\alpha & \beta\\
-\frac ct & \frac at
\end{pmatrix}
\in \Gamma (1)
\,.
\]
Dann ist
\[
\begin{pmatrix}
\alpha & \beta\\
-\frac ct & \frac at
\end{pmatrix} \abcd
= \begin{pmatrix}
* & *\\ 0 & *
\end{pmatrix}
\,.
\]
Man kann also voraussetzen, dass $c = 0$. Wegen $\det M = n$ gilt dann $ad = n$. Multipliziert man gegebenenfalls mit $- E$, so kann man annehmen, dass $d > 0$. Schließlich multipliziere für $\nu \in \ZZ$ mit 
\[
\begin{pmatrix}
1 & \nu\\
0 & 1
\end{pmatrix} 
\in \Gamma (1) \Ra 
\begin{pmatrix}
1 & \nu\\
0 & 1
\end{pmatrix}
\begin{pmatrix}
a & b\\
0 & d
\end{pmatrix}
= 
\begin{pmatrix}
a & b + \nu d\\
0 & d
\end{pmatrix}
\,.
\]
Durch geeignete Wahl von $\nu \in \ZZ$ kann man erreichen, dass $b + \nu d$ in einem vorgegebenen Restsystem modulo $d$ liegt. Damit ist die Inklusion $\subset$ gezeigt.

Noch zu zeigen ist, dass die Vereinigung disjunkt ist (die Endlichkeit ist nach Konstruktion klar). Angenommen, für zwei Matrizen
\[
\begin{pmatrix}
a & b\\
0 & d
\end{pmatrix},
\begin{pmatrix}
a' & b'\\
0 & d'
\end{pmatrix}
\]
(mit $ad = n = a'd'$, $d > 0$, $d' > 0$ und $b, b'$ Vertreter zweier Restklassen modulo $d$ bzw.\ $d'$) existiere ein $N \in \Gamma (1)$, sodass
\[
N 
\begin{pmatrix}
a & b\\
0 & d
\end{pmatrix}
= 
\begin{pmatrix}
a' & b'\\
0 & d'
\end{pmatrix}
\,.
\]
Dann folgt, dass die untere linke Komponente von $N$ Null ist, $N \in \SL_2(\ZZ)$ also die Gestalt
\[
N = 
\begin{pmatrix}
\pm 1 & \nu\\
0 & \pm 1
\end{pmatrix}
\]
mit $\nu \in \ZZ$ hat. Damit ist 
\[
N
\begin{pmatrix}
a & b\\
0 & d
\end{pmatrix}
=
\begin{pmatrix}
\pm 1 & \nu\\
0 & \pm 1
\end{pmatrix}
\begin{pmatrix}
a & b\\
0 & d
\end{pmatrix}
= 
\begin{pmatrix}
\pm a & \pm b + \nu d\\ 
0 & \pm d
\end{pmatrix}
\overset !=
\begin{pmatrix}
a' & b'\\ 
0 & d'
\end{pmatrix}
\,.
\]
Es folgt $d' = \pm d$ und da $d, d' > 0$ nach Voraussetzung bereits $d = d'$. Die Diagonalelemente von $N$ sind also beide $+1$ und es folgt $b' = b + \nu d$. Wegen $d = d'$ stammen $b, b'$ beide aus dem gleichen Restsystem modulo $d$. Da sie sich nur um ein Vielfaches von $d$ unterscheiden, folgt
\[
\begin{pmatrix}
a' & b' \\ 0 & d'
\end{pmatrix} = \begin{pmatrix}
a & b \\ 0 & d
\end{pmatrix}
\,.
\]
\end{bewe}

\begin{defi}
Sei $n \in \NN$. Man setze dann für $f \in M_k$
\[
f | T(n) := n^{\frac k2 - 1} \smashoperator{\sum_{M \in \linksmodulo{\Gamma(1)}{\mathcal M (n)}}} f |_k M
\,.
\]
\end{defi}

\begin{satz-list}\label{TnEndoMk}
\item Durch $T(n)$ wird eine lineare Abbildung $M_k \to M_k$ definiert. Diese lässt $S_k$ invariant (gemeint ist: Spitzenformen werden auf Spitzenformen geschickt). Man nennt $T(n)$ den $n$-ten \myemph{Hecke-Operator}.
\item Ist $f = \sum_{m \geq 0} a(m) q^m \in M_k$, so gilt
\[
f | T(n) = \sum_{m \geq 0} \left( \sum_{d | (m,n)} d^{k-1} a\left(\frac{mn}{d^2}\right) \right) q^m
\,.
\]

\emph{Beachte:} Der konstante Term von $f | T(n)$ ist gleich
\[
\sum_{d|n} d^{k-1} a(0) = \sigma_{k-1}(n) a(0)
\,.
\]
\end{satz-list}

\begin{bsp}
Sei $n = p$ prim. Dann ist
\begin{align*}
f | T(p) &= \sum_{m \geq 0} \left( \sum_{d | (m,p)} d^{k-1} a\left(\frac{mp}{d^2}\right) \right) q^m\\
&= \sum_{m \geq 0} \Bigl( a(mp) + p^{k-1} a\Bigl( \frac mp\Bigr) \Bigr) q^m
\,,
\end{align*}
wobei $a\left(\frac mp\right) := 0$ für $p \!\! \not | \, m$, denn
\[
\sum_{d | (m,p)} d^{k-1} a \left( \frac {mn}{d^2} \right) = a(mp) + 
\begin{cases}
0 & \text{ falls } p \!\! \not | \, m\\ 
p^{k-1} a \left(\frac mp \right) & \text{ falls } p | \, m
\end{cases}
\,.
\]
\end{bsp}

\begin{bewe-list}
\item Nach den Überlegungen in \autoref{VorbemerkungHecke} wissen wir, dass $f | T(n)$ das Transformationsverhalten einer Modulform vom Gewicht $k$ besitzt. Auch ist $f | T(n)$ als Summe holomorpher Funktionen selbst holomorph auf $\HH$. Zu zeigen verbleibt noch, dass $f | T(n)$ holomorph in $\infty$ ist und den Raum $S_k$ invariant lässt. Beides folgt direkt aus Teil ii) des Satzes.

\item Benutze \autoref{lemma:Mn_schoen}, damit folgt
\begin{align*}
f|T(n)
&= n^{\frac{k}{2}-1} \smashoperator{\sum_{\substack{ad=n\\ d>0 \\ b\bmod d}}} f|_k \mymat ab0d \\
&= n^{\frac{k}{2}-1} \smashoperator{\sum_{\substack{ad=n\\ d>0 \\ b\bmod d}}} n^{\frac{k}{2}} d^{-k} f\Bigl(\frac{az+b}{d}\Bigr) \\
&= n^{k-1} \smashoperator{\sum_{\substack{m \geq 0\\ ad=n,\ d>0\\ b\bmod d}}} d^{-k} a(m) e^{2\pi im \frac{az+b}{d}} \\
&= n^{k-1} \smashoperator{\sum_{\substack{m \geq 0\\ d|n,\ d>0}}} \, \biggl( d^{-k} a(m) e^{2\pi im \frac{n}{d^2}z} \cdot \smashoperator{\sum_{b\bmod d}} e^{2\pi im \frac{b}{d}}\biggr)
\,.
\end{align*}

% einschub
Es gilt nun
\[
\smashoperator{\sum_{b \bmod d}} e^{2\pi im \frac{b}{d}}
= \begin{cases}
0 & \text{falls } d\nmid m \\
d & \text{falls } d| m
\end{cases}
\,,
\]

denn allgemein ist $1+q+\ldots q^{N-1} = \frac{q^N-1}{q-1} = 0$, falls $q\not=1$ und $q^N = 1$. Wende dies an mit $q=e^{2\pi i \frac{m}{d}}$, $N=d$.
% einschub ende
Damit erhalten wir, wobei zu beachten ist, dass die Vertauschungen wegen absoluter Konvergenz gerechtfertigt sind
\begin{align*}
f|T(n)
&= n^{k-1} \smashoperator{\sum_{\substack{m \geq 0 \\ m \equiv 0 \bmod d \\ d|n,\ d > 0}}} d^{-k+1} a(m) e^{2\pi i\frac{mn}{d^2}z} &&(m\mapsto md) \\
&= \smashoperator{\sum_{\substack{m \geq 0\\ d|n,\ d>0}}} \, \Bigl(\frac{n}{d}\Bigr)^{k-1} a(md) e^{2\pi i \frac{mn}{d}z} &&\Bigl(d\mapsto\frac{n}{d}\Bigr) \\
&= \smashoperator{\sum_{\substack{m \geq 0 \\ d|n,\ d>0}}} d^{k-1} a\Bigl(\frac{mn}{d}\Bigr) e^{2\pi imdz} && (md\mapsto m) \\
&= \smashoperator{\sum_{\substack{m\geq 0 \\ m\equiv 0 \bmod d \\ d|n,\ d>0}}} d^{k-1} a\Bigl(\frac{mn}{d^2}\Bigr) e^{2\pi imz} \\
&= \sum_{m\geq 0} \left(\sum_{\substack{d|m\\d|n}} d^{k-1} a\biggl(\frac{mn}{d^2}\biggr)\right) q^m
\,.
\end{align*}
\end{bewe-list}

\begin{satz}\label{TmTn}
	Für alle $m$, $n \in \NN$ gilt
	\[
	T(m) T(n) = \sum_{d | (m,n)} d^{k-1} T \left( \frac {mn}{d^2} \right)
	\,.
	\]
	Speziell gilt (vergleiche mit Ramanujan-$\tau$-Funktion):
	\begin{enumerate}
		\item $T(n)T(m) = T(mn)$ falls $\ggt(m,n) = 1$.
		\item $T(p) T(p^\nu) = T(p^{\nu+1}) + p^{k-1} T(p^{\nu-1})$ für $p$ prim und $\nu \geq 1$.
	\end{enumerate}
	
	Beachte dass (ii) äquivalent ist zur Identität
	\[
	\frac{1}{1-T(p)X+p^{k-1}X^2} = \sum_{\nu \geq 0} T(p^\nu) X^\nu
	\,.
	\]
\end{satz}

\begin{bewe}
	in mehreren Schritten:
	1. Schritt: Beweis von (i):
	Seien $m$, $n$ teilerfremd.
	Benutze \autoref{lemma:Mn_schoen} und \autoref{TnEndoMk}, dann gilt
	\begin{align*}
	f|T(m)T(n)
	&= (mn)^{\frac{k}{2}-1} \smashoperator[l]{\sum_{\substack{ad=m \vphantom{d'} \\ d>0,\ \vphantom{b'}b\bmod d}}} \Biggl(\smashoperator[r]{\sum_{\substack{a'd' = n\\ d'>0,\ b' \bmod d'}}} f|_k \mymat ab0d \mymat{a'}{b'}{0}{d'} \Biggr) \\
	&= (mn)^{\frac{k}{2}-1} \smashoperator[l]{\sum_{\substack{ad=m \vphantom{d'} \\ d>0,\ \vphantom{b'}b\bmod d}}} \Biggl(\smashoperator[r]{\sum_{\substack{a'd' = n\\ d'>0,\ b' \bmod d'}}} f|_k \mymat{aa'}{ab'+bd'}{0}{dd'} \Biggr)
	\,.
	\end{align*}
	Durchläuft $d$ alle positiven Teiler von $m$ und $d'$ alle positiven Teiler von $n$, so durchläuft $D := dd'$ alle positiven Teiler von $mn$, denn $\ggt(m, n) = 1$.
	Setzt man $A := aa'$, so gilt dann $AD = mn$.
	Ferner gilt: Durchläuft $b$ ein volles Restsystem $\bmod d$ und $b'$ ein solches $\bmod d'$, so durchläuft $B = ab+bd'$ ein volles Restsystem $\bmod dd'$, denn in der Tat genügt es zu zeigen, dass diese Zahlen inkongruent $\bmod dd'$ sind, denn dann sind dies genau $dd'$ paarweise inkongruente Zahlen.
	Angenommen
	\[
	ab_1' + b_1d' \equiv ab_2' +b_2d' \mod dd'
	\,,
	\]
	dann gilt
	\[
	a(b_1' - b_2') \equiv d'(b_2 - b_1) \mod dd'
	\,.
	\]
	Dies impliziert $a(b_1'- b_2') \equiv 0 \mod d'$. Aber $\ggt(a, d') = 1$, denn $a|m$ und $d'|n$ und $\ggt(m, n) = 1$ nach Voraussetzung.
	Also folgt $b_1' \equiv b_2' \mod d'$, also $b_1' = b_2'$.
	Es folgt jetzt $b_2 \equiv b_1 \mod d$, also $b_2 = b_1$.
	Also folgt die Behauptung.
	Und damit
	\[
	f|T(m)T(n)
	= (mn)^{\frac{k}{2}-1} \smashoperator{\sum_{\substack{AD = mn\\ D > 0,\ B \bmod D}}} f|_k \mymat AB0D
	= f|_kT(mn)
	\,.
	\]
	
	
	2. Schritt: Beweis von (ii):
	Es gilt nach \autoref{lemma:Mn_schoen} und \autoref{TnEndoMk}:
	\[
	f|T(p) = p^{\frac{k}{2}-1} \Bigl(f|_k \mymat p001 + \smashoperator{\sum_{\mu \bmod p}} f|_k \mymat 1\mu0p \Bigr)
	\]
	und
	\[
	f|T(p^\nu) = (p^\nu)^{\frac{k}{2}-1} \smashoperator{\sum_{\substack{0 \leq \beta \leq \nu \\ b \bmod p^\beta}}} f|_k \mymat{p^{\nu-\beta}}b0{p^\beta}
	\,.
	\]
	
	Dann
	\begin{align}\label{eq:tptpnu}
	f|T(p)T(p^\nu)
	&= (p^{\nu+1})^{\frac{k}{2}-1} \biggl( \smashoperator[r]{\sum_{\substack{0 \leq \beta \leq \nu \\ b \bmod p^\beta}}} f|_k \mymat p001 \mymat {p^{\nu-\beta}}b0{p^\beta} + \smashoperator{\sum_{\substack{0 \leq \beta \leq \nu \\ b \bmod p^\beta \\ \mu\bmod p}}} f|_k \mymat 1\mu0p \mymat {p^{\nu-\beta}}b0{p^\beta} \biggr) \nonumber \\
	&= (p^{\nu+1})^{\frac{k}{2}-1} \biggl( \smashoperator[r]{\sum_{\substack{0 \leq \beta \leq \nu\\b \bmod p^\beta}}} f|_k \mymat {p^{\nu +1-\beta}}{pb}{0}{p^\beta} + \smashoperator{\sum_{\substack{0 \leq \beta \leq \nu \\ b \bmod p^\beta \\ \mu \bmod p}}} f|_k \mymat{p^{\nu-\beta}}{b+\mu p^\beta}0{p^{\beta+1}} \biggr)
	\,.
	\end{align}
	Betrachte 2. Summe in \eqref{eq:tptpnu}:
	Durchläuft $b$ ein Restsystem modulo $p^\beta$ und $\mu$ ein Restsystem modulo $p$, so durchläuft $b+\mu p^\beta$ ein solches modulo $p^{\beta+1}$ (denn insgesamt $p^{\beta+1}$ Zahlen, paarweise inkongruent modulo $p^{\beta+1}$).
	Man sieht daher, dass die 2. Summe gleich
	\[
	f|T(p^{\nu+1}) - (p^{\nu+1})^{\frac{k}{2}-1} f|_k \mymat {p^{\nu+1}}001
	\]
	ist.
	
	Betrachte 1. Summe in \eqref{eq:tptpnu}. Diese ist gleich
	\[
	(p^{\nu + 1})^{\frac{k}{2}-1} \biggl(f|_k \mymat{p^{\nu+1}}001 + \smashoperator{\sum_{\substack{1 \leq \beta \leq \nu \\ b \bmod p^\beta}}} f|_k \mymat{p^{\nu+1-\beta}}{pb}0{p^\beta} \biggr)
	\,.
	\]
	Man erhält also
	\[
	f|_k T(p)T(p^\nu)
	= f|T(p^{\nu+1}) + (p^{\nu+1})^{\frac{k}{2}-1}  \underbrace{\smashoperator[r]{\sum_{\substack{1 \leq \beta \leq \nu\\ b \bmod p^\beta}}} f|_k \mymat p00p |_k \mymat {p^{\nu-\beta}}b0{p^{\beta-1}}}_{=: R}
	\]
	In $R$ ersetze $\beta$ durch $\beta + 1$, erhalte
	\[
	R = \smashoperator{\sum_{\substack{0 \leq \beta \leq \nu-1\\ b \bmod p^{\beta+1}}}} f|_k \mymat {p^{\nu-1-\beta}}b0{p^{\beta}}
	\,,
	\]
	Man setze $b = \tilde b + \mu p^\beta$ wobei $\mu$ modulo $p$ und $\tilde b$ modulo $p^\beta$ läuft:
	\[
	R = \smashoperator{\sum_{\substack{ 0 \leq \beta \leq \nu-1\\ \tilde b \bmod p^\beta \\ \mu \bmod p}}} f|_k \mymat 1\mu01 |_k \mymat {p^{\nu-1-\beta}}{\tilde b}0{p^\beta}
	\,.
	\]
	Da $f$ Periode 1 hat, erhält man
	\[
	(p^{\nu+1})^{\frac{k}{2}-1}R
	= p^{k-1}(p^{\nu-1})^{\frac{k}{2}-1} \smashoperator{\sum_{\substack{0 \leq \beta \leq \nu-1 \\ \tilde b \bmod p^\beta}}} f|_k \mymat {p^{\nu-1-\beta}}{\tilde b}0{p^\beta}
	= p^{k-1} f|T(p^{\nu-1})
	\,.
	\]
	
	3. Schritt: zeige durch Induktion nach $\nu \in \NN$ (Übungsaufgabe), dass 
	\[
	T(p^\nu) T(p^s) = \smashoperator{\sum_{\alpha = 0}^{\min \{\nu,\,s\}}} \, (p^\alpha)^{k-1} T(p^{\nu + s - 2\alpha})
	\,,
	\]
	was sich mit Teilern der Form $d = p^\alpha$ umschreiben lässt zu
	\[
	T(p^\nu) T(p^s) = \smashoperator{\sum_{d \vert (p^\nu, p^s)}} d^{k-1} T\Bigl(\frac{p^{\nu + s}}{d^2}\Bigr)
	\,.
	\]
	
	4. Schritt: der allgemeine Fall! Induktion über die verschiedenen Primteiler von $m$. Sei $m = p^\nu m'$, $n = p^s n'$ mit $p \nmid m', p \nmid n'$. Dann folgt mit i), dass
	\begin{align*}
	T(m)T(n)
	&= T(m'p^\nu) T(n'p^s)
	= T(m')T(p^\nu)T(n')T(p^s) \\
	&= T(m')T(n') T(p^\nu) T(p^s)
	\,.
	\end{align*}
	Wendet man dieses Argument nun induktiv auf $T(m')T(n')$ und weitere gemeinsame Primteiler an, so kann man davon ausgehen, dass $m', n'$ nach endlich vielen Iterationen teilerfremd sind. Dann kann man mit i) und Schritt 3 schreiben
	\[
	T(m)T(n) = \left(\smashoperator[r]{\sum_{d \vert (m',n')}} d^{k-1} T\Bigl(\frac {m'n'}{d^2}\Bigr)\right) \left(\smashoperator[r]{\sum_{t \vert (p^\nu, p^s)}} t^{k-1} T\Bigl(\frac{p^\nu p^s}{t^2}\Bigr) \right)
	\,,
	\]
	was sich nach erneuter Anwendung von i) vereinfacht zu
	\[
	T(m)T(n) = \smashoperator{\sum_{\substack{d \vert (m',n')\\t \vert (p^\nu, p^s)}}} (dt)^{k-1} T\Bigl(\frac {p^\nu m'p^s n'}{(dt)^2}\Bigr)
	\]
	und mit $D = dt$ schließlich zu
	\[
	T(m)T(n) = \smashoperator{\sum_{D \vert (m,n)}} D^{k-1} T\Bigl(\frac {mn}{D^2}\Bigr)
	\,.
	\]
\end{bewe}
